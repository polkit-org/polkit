<?xml version="1.0" encoding="UTF-8"?>
<!--
  Copyright 2008, 2009, 2015, 2024 Red Hat
  Copyright 2023, 2024 Luca Boccassi

  SPDX-License-Identifier: LGPL-2.1-or-later

  This library is free software; you can redistribute it and/or
  modify it under the terms of the GNU Lesser General Public
  License as published by the Free Software Foundation; either
  version 2.1 of the License, or (at your option) any later version.

  This library is distributed in the hope that it will be useful,
  but WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
  Lesser General Public License for more details.

  You should have received a copy of the GNU Lesser General Public
  License along with this library; if not, write to the Free Software
  Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA

  Authors:
   - David Zeuthen <davidz@redhat.com>
   - Colin Walters <walters@redhat.com>
   - Miloslav Trmaƒç <mitr@redhat.com>
   - Luca Boccassi <luca.boccassi@gmail.com>
   - Jan Rybar <jrybar@redhat.com>
-->
<!DOCTYPE node PUBLIC "-//freedesktop//DTD D-BUS Object Introspection 1.0//EN"
"http://www.freedesktop.org/standards/dbus/1.0/introspect.dtd">
<node>

  <interface name="org.freedesktop.PolicyKit1.Authority">
    <property name="BackendName" type="s" access="read"/>

    <property name="BackendVersion" type="s" access="read"/>

    <property name="BackendFeatures" type="u" access="read"/>

    <method name="EnumerateActions">
      <arg name="locale" direction="in" type="s"/>

      <arg name="action_descriptions" direction="out" type="a(ssssssuuua{ss})"/>
    </method>

    <method name="CheckAuthorization">
      <arg name="subject" direction="in" type="(sa{sv})"/>

      <arg name="action_id" direction="in" type="s"/>

      <arg name="details" direction="in" type="a{ss}"/>

      <arg name="flags" direction="in" type="u"/>

      <arg name="cancellation_id" direction="in" type="s"/>

      <arg name="result" direction="out" type="(bba{ss})"/>
    </method>

    <method name="CancelCheckAuthorization">
      <arg name="cancellation_id" direction="in" type="s"/>
    </method>

    <method name="RegisterAuthenticationAgent">
      <arg name="subject" direction="in" type="(sa{sv})"/>

      <arg name="locale" direction="in" type="s"/>

      <arg name="object_path" direction="in" type="s"/>
    </method>

    <method name="UnregisterAuthenticationAgent">
      <arg name="subject" direction="in" type="(sa{sv})"/>

      <arg name="object_path" direction="in" type="s"/>
    </method>

    <method name="AuthenticationAgentResponse">
      <arg name="cookie" direction="in" type="s"/>

      <arg name="identity" direction="in" type="(sa{sv})"/>
    </method>

    <method name="AuthenticationAgentResponse2">
      <arg name="uid" direction="in" type="u"/>

      <arg name="cookie" direction="in" type="s"/>

      <arg name="identity" direction="in" type="(sa{sv})"/>
    </method>

    <method name="EnumerateTemporaryAuthorizations">
      <arg name="subject" direction="in" type="(sa{sv})"/>

      <arg name="temporary_authorizations" direction="out" type="a(ss(sa{sv})tt)"/>
    </method>

    <method name="RevokeTemporaryAuthorizations">
      <arg name="subject" direction="in" type="(sa{sv})"/>
    </method>

    <method name="RevokeTemporaryAuthorizationById">
      <arg name="id" direction="in" type="s"/>
    </method>

    <method name="AddLockdownForAction">
      <arg name="action_id" direction="in" type="s"/>
    </method>

    <method name="RemoveLockdownForAction">
      <arg name="action_id" direction="in" type="s"/>
    </method>

    <signal name="Changed"/>

  </interface>
</node>
